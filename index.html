<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"
    />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>JOJO Game</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <link href="index.css" rel="stylesheet" />
  </head>

  <body onload="startGame()">
    <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
      integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
      integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
      crossorigin="anonymous"
    ></script>

    <div class="ratio ratio-4x3">
      <div class="canvas-wrap">
        <canvas
          class="cover-fit"
          id="myCanvas"
          width="100%"
          height="100%"
        ></canvas>
      </div>
    </div>
    <script>
      var myGamePiece;
      var myBackground;

      var gamecanvas = document.getElementById("myCanvas");
      var bgwidth = gamecanvas.width;
      var bgheight = gamecanvas.height;

      function startGame() {
        myGamePiece1 = new component(
          225,
          225,
          "img/CH_cheng.png",
          200,
          130,
          "image"
        );
        myGamePiece2 = new component(
          225,
          225,
          "img/flower.png",
          360,
          120,
          "image"
        );
        myGamePiece3 = new component(
          225,
          125,
          "img/test.png",
          100,
          320,
          "image"
        );
        myGamePiece4 = new component(
          225,
          125,
          "img/test.png",
          600,
          120,
          "image"
        );
        myGamePiece5 = new component(
          125,
          125,
          "img/CH_cheng.png",
          400,
          415,
          "image"
        );
        myBackground = new component(800, 600, "img/bg.jpg", 0, 0, "image");
        myGameArea.start();
      }

      var myGameArea = {
        canvas: gamecanvas,
        start: function () {
          this.canvas.width = 800;
          this.canvas.height = 600;
          this.context = this.canvas.getContext("2d");
          document.body.insertBefore(this.canvas, document.body.childNodes[0]);
          this.frameNo = 0;
          this.interval = setInterval(updateGameArea, 20);
        },
        clear: function () {
          this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);
        },
        stop: function () {
          clearInterval(this.interval);
        },
      };

      function component(width, height, color, x, y, type) {
        this.type = type;
        if (type == "image") {
          this.image = new Image();
          this.image.src = color;
        }

        this.width = width;
        this.height = height;
        this.speedX = 0;
        this.speedY = 0;
        this.x = x;
        this.y = y;
        this.update = function () {
          ctx = myGameArea.context;
          if (type == "image") {
            ctx.drawImage(this.image, this.x, this.y, this.width, this.height);
          } else {
            ctx.fillStyle = color;
            ctx.fillRect(this.x, this.y, this.width, this.height);
          }
        };
        this.newPos = function () {
          this.x += this.speedX;
          this.y += this.speedY;
        };
      }

      function updateGameArea() {
        myGameArea.clear();
        myBackground.newPos();
        myBackground.update();
        myGamePiece1.newPos();
        myGamePiece1.update();
        myGamePiece2.newPos();
        myGamePiece2.update();
        myGamePiece4.newPos();
        myGamePiece4.update();
        myGamePiece3.newPos();
        myGamePiece3.update();
      }

      function move(dir) {
        myGamePiece.image.src = "flower.png";
        if (dir == "up") {
          myGamePiece.speedY = -1;
        }
        if (dir == "down") {
          myGamePiece.speedY = 1;
        }
        if (dir == "left") {
          myGamePiece.speedX = -1;
        }
        if (dir == "right") {
          myGamePiece.speedX = 1;
        }
      }

      function clearmove() {
        myGamePiece.image.src = "CH_DIO.png";
        myGamePiece.speedX = 0;
        myGamePiece.speedY = 0;
      }
    </script>
  </body>
</html>
